import numpy as np
import re

def atoi(text):
    return int(text) if text.isdigit() else text

def natural_keys(text):
    '''
    alist.sort(key=natural_keys) sorts in human order
    http://nedbatchelder.com/blog/200712/human_sorting.html
    (See Toothy's implementation in the comments)
    '''
    return [ atoi(c) for c in re.split('(\d+)', text) ]

def readList(list_path,ignore_head=False, sort=True):
    lists = []
    with open(list_path) as f:
        lists = f.read().splitlines()
    if ignore_head:
        lists = lists[1:]
    if sort:
        lists.sort(key=natural_keys)
    return lists

def light_source_directions():
    """
    Below matrix is from DiLiGenT.
    :return: light source direction matrix. [light_num, 3]
    :rtype: np.ndarray
    """
    L = np.array([[-0.084766, -0.985072, 0.149823],
                  [-0.168684, -0.985072, -0.034319],
                  [-0.019487, -0.985072, -0.171034],
                  [-0.004654, -0.999008, 0.044277],
                  [0.156623, -0.985075, -0.071392],
                  [0.116297, -0.985075, 0.126896],
                  [-0.256908, -0.959314, 0.117112],
                  [-0.190769, -0.959314, -0.208144],
                  [0.139006, -0.959314, -0.245752],
                  [0.276679, -0.959314, 0.056261],
                  [0.029984, -0.957676, 0.286282],
                  [-0.169271, -0.937415, 0.304302],
                  [-0.341716, -0.937415, -0.066951],
                  [-0.041921, -0.937415, -0.345680],
                  [0.315807, -0.937415, -0.146691],
                  [0.237101, -0.937415, 0.255020],
                  [-0.047792, -0.897583, 0.438248],
                  [-0.346984, -0.899007, 0.267187],
                  [-0.428932, -0.899117, 0.087212],
                  [-0.361334, -0.899007, -0.247436],
                  [-0.215491, -0.899117, -0.380988],
                  [0.123668, -0.899007, -0.420111],
                  [0.295751, -0.899117, -0.322676],
                  [0.437765, -0.899007, -0.012207],
                  [0.398275, -0.899117, 0.181564],
                  [0.146886, -0.899007, 0.412567],
                  [-0.251650, -0.857717, 0.448323],
                  [-0.504145, -0.857717, -0.100794],
                  [-0.059928, -0.857717, -0.510617],
                  [0.467107, -0.857717, -0.214785],
                  [0.348616, -0.857717, 0.377873],
                  [-0.135062, -0.791270, 0.596364],
                  [-0.441621, -0.791270, 0.422921],
                  [-0.538963, -0.803963, 0.251322],
                  [-0.608912, -0.791270, 0.055835],
                  [-0.538690, -0.791270, -0.289317],
                  [-0.405570, -0.803963, -0.434921],
                  [-0.241266, -0.791270, -0.561856],
                  [0.108692, -0.791270, -0.601729],
                  [0.288306, -0.803963, -0.520118],
                  [0.459802, -0.791270, -0.403081],
                  [0.605866, -0.791270, -0.082572],
                  [0.583754, -0.803963, 0.113470],
                  [0.525439, -0.791270, 0.312738],
                  [0.265753, -0.791270, 0.550697],
                  [0.072473, -0.803963, 0.590247],
                  [-0.323880, -0.748956, 0.578072],
                  [-0.649863, -0.748956, -0.129394],
                  [-0.077758, -0.748956, -0.658042],
                  [0.601806, -0.748956, -0.277298],
                  [0.449695, -0.748956, 0.486662],
                  [-0.022974, -0.678911, 0.733861],
                  [-0.619528, -0.681998, 0.388668],
                  [-0.698754, -0.682310, 0.214932],
                  [-0.561090, -0.681998, -0.469101],
                  [-0.420340, -0.682310, -0.598137],
                  [0.272756, -0.681998, -0.678589],
                  [0.438970, -0.682310, -0.584601],
                  [0.729662, -0.681998, 0.049710],
                  [0.691638, -0.682310, 0.236833],
                  [0.178200, -0.681998, 0.709312],
                  [-0.209287, -0.658689, 0.722722],
                  [-0.510638, -0.658757, 0.552529],
                  [-0.752023, -0.658689, 0.024290],
                  [-0.683282, -0.658757, -0.314905],
                  [-0.255489, -0.658689, -0.707710],
                  [0.088346, -0.658757, -0.747151],
                  [0.594122, -0.658689, -0.461679],
                  [0.737883, -0.658757, -0.146860],
                  [0.622677, -0.658689, 0.422377],
                  [0.367690, -0.658757, 0.656387],
                  [-0.385692, -0.615218, 0.687567],
                  [-0.773101, -0.615218, -0.154345],
                   [-0.092110, -0.615218, -0.782958],
                   [0.716173, -0.615218, -0.329549],
                   [0.534730, -0.615218, 0.579285],
                   [-0.673182, -0.530448, 0.515219],
                   [-0.766262, -0.537498, 0.352047],
                   [-0.829522, -0.530906, 0.173296],
                   [-0.698027, -0.530448, -0.481023],
                   [-0.571605, -0.537498, -0.619970],
                   [-0.421151, -0.530906, -0.735371],
                   [0.241778, -0.530448, -0.812508],
                   [0.412991, -0.537498, -0.735210],
                   [0.569237, -0.530906, -0.627781],
                   [0.847454, -0.530448, -0.021134],
                   [0.826848, -0.537498, 0.165585],
                   [0.772959, -0.530906, 0.347382],
                   [-0.564927, -0.501511, 0.655244],
                   [-0.865144, -0.501511, -0.003523],
                   [-0.797746, -0.501511, -0.334796],
                   [-0.263993, -0.501511, -0.823890],
                   [0.071893, -0.501511, -0.862159],
                   [0.701987, -0.501511, -0.505669],
                   [0.842178, -0.501511, -0.198048],
                   [0.697845, -0.501511, 0.511370],
                   [0.448602, -0.501511, 0.739759],
                   [-0.433635, -0.460414, 0.774584],
                   [-0.870674, -0.460414, -0.173052],
                   [-0.104471, -0.460414, -0.881536],
                   [0.806155, -0.460200, -0.371927],
                   [0.602839, -0.460200, 0.651768],
                   [-0.367544, -0.325568, 0.871158],
                   [-0.554092, -0.325568, 0.766151],
                   [-0.678211, -0.363455, 0.638695],
                   [-0.790254, -0.382683, 0.478595],
                   [-0.879157, -0.379225, 0.288566],
                   [-0.926588, -0.363634, 0.095946],
                   [-0.942098, -0.325568, -0.080352],
                   [-0.899877, -0.325568, -0.290219],
                   [-0.817013, -0.363455, -0.447649],
                   [-0.699372, -0.382683, -0.603682],
                   [-0.546118, -0.379225, -0.746956],
                   [-0.377581, -0.363634, -0.851588],
                   [-0.214705, -0.325568, -0.920819],
                   [-0.002063, -0.325568, -0.945516],
                   [0.173269, -0.363455, -0.915357],
                   [0.358018, -0.382683, -0.851691],
                   [0.541638, -0.379225, -0.750211],
                   [0.693230, -0.363634, -0.622256],
                   [0.809403, -0.325568, -0.488745],
                   [0.898602, -0.325568, -0.294142],
                   [0.924099, -0.363455, -0.118073],
                   [0.920639, -0.382683, 0.077308],
                   [0.880868, -0.379225, 0.283301],
                   [0.806021, -0.363634, 0.467013],
                   [0.714944, -0.325568, 0.618758],
                   [0.557429, -0.325568, 0.763726],
                   [0.397856, -0.363455, 0.842384],
                   [-0.480342, -0.177330, 0.858968],
                   [-0.658965, -0.173648, 0.731855],
                   [-0.784183, -0.195946, 0.588781],
                   [-0.884825, -0.216440, 0.412601],
                   [-0.954564, -0.197035, 0.223571],
                   [-0.984618, -0.173648, 0.019335],
                   [-0.965361, -0.177330, -0.191397],
                   [-0.899667, -0.173648, -0.400557],
                   [-0.802290, -0.195946, -0.563859],
                   [-0.665832, -0.216440, -0.714018],
                   [-0.507606, -0.197035, -0.838757],
                   [-0.322653, -0.173648, -0.930452],
                   [-0.116284, -0.177330, -0.977257],
                   [0.102940, -0.173648, -0.979413],
                   [0.288340, -0.195946, -0.937265],
                   [0.473318, -0.216440, -0.853888],
                   [0.640847, -0.197035, -0.741952],
                   [0.785208, -0.173648, -0.594386],
                   [0.893493, -0.177330, -0.412582],
                   [0.963287, -0.173648, -0.204753],
                   [0.980494, -0.195946, -0.015403],
                   [0.958359, -0.216440, 0.186286],
                   [0.903671, -0.197035, 0.380206],
                   [0.807938, -0.173648, 0.563101],
                   [0.668493, -0.177330, 0.722268],
                   [0.492404, -0.173648, 0.852869],
                   [-0.401412, -0.003879, 0.915889],
                   [-0.570692, -0.008726, 0.821118],
                   [-0.729864, -0.021330, 0.683260],
                   [-0.863979, -0.026177, 0.502848],
                   [-0.944053, -0.026177, 0.328754],
                   [-0.991915, -0.017452, 0.125699],
                   [-0.995106, -0.003879, -0.098740],
                   [-0.957283, -0.008726, -0.289021],
                   [-0.875359, -0.021330, -0.483003],
                   [-0.745220, -0.026177, -0.666304],
                   [-0.604392, -0.026177, -0.796257],
                   [-0.426065, -0.017452, -0.904524],
                   [-0.213597, -0.003879, -0.976914],
                   [-0.020942, -0.008726, -0.999743],
                   [0.188862, -0.021330, -0.981772],
                   [0.403407, -0.026177, -0.914646],
                   [0.570518, -0.026177, -0.820868],
                   [0.728592, -0.017452, -0.684726],
                   [0.863095, -0.003879, -0.505026],
                   [0.944340, -0.008726, -0.328854],
                   [0.992082, -0.021330, -0.123766],
                   [0.994540, -0.026177, 0.101021],
                   [0.956991, -0.026177, 0.288933],
                   [0.876360, -0.017452, 0.481340],
                   [0.747020, -0.003879, 0.664791],
                   [0.604576, -0.008726, 0.796500],
                   [0.424279, -0.021330, 0.905280],
                   [-0.473611, 0.158988, 0.866265],
                   [-0.647866, 0.157546, 0.745284],
                   [-0.791148, 0.136612, 0.596173],
                   [-0.896967, 0.143205, 0.418262],
                   [-0.968518, 0.134233, 0.209654],
                   [-0.987037, 0.159086, 0.021206],
                   [-0.970221, 0.158988, -0.182741],
                   [-0.909009, 0.157546, -0.385851],
                   [-0.811472, 0.136612, -0.568199],
                   [-0.674969, 0.143205, -0.723816],
                   [-0.498681, 0.134233, -0.856329],
                   [-0.325179, 0.159086, -0.932175],
                   [-0.126018, 0.158988, -0.979205],
                   [0.086067, 0.157546, -0.983754],
                   [0.289630, 0.136612, -0.947339],
                   [0.479813, 0.143205, -0.865605],
                   [0.660316, 0.134233, -0.738894],
                   [0.786065, 0.159086, -0.597322],
                   [0.892338, 0.158988, -0.422441],
                   [0.962202, 0.157546, -0.222142],
                   [0.990474, 0.136612, -0.017289],
                   [0.971510, 0.143205, 0.188842],
                   [0.906779, 0.134233, 0.399667],
                   [0.810994, 0.159086, 0.563010],
                   [0.677513, 0.158988, 0.718122],
                   [0.508606, 0.157546, 0.846463],
                   [-0.878987, 0.245068, 0.409052],
                   [-0.962624, 0.236694, 0.131645],
                   [-0.949565, 0.254829, -0.182728],
                   [-0.846445, 0.238096, -0.476278],
                   [-0.660654, 0.245068, -0.709562],
                   [-0.422669, 0.236694, -0.874830],
                   [-0.119647, 0.254829, -0.959556],
                   [0.191401, 0.238096, -0.952195],
                   [0.470680, 0.245068, -0.847586],
                   [0.701401, 0.236694, -0.672319],
                   [0.875619, 0.254829, -0.410310],
                   [0.964738, 0.238096, -0.112211],
                   [0.951550, 0.245068, 0.185725],
                   [0.856158, 0.236694, 0.459314],
                   [-0.806939, 0.337054, 0.485019],
                   [-0.908289, 0.359948, 0.213187],
                   [-0.936441, 0.341220, -0.081526],
                   [-0.857853, 0.359948, -0.366777],
                   [-0.766193, 0.359948, -0.532340],
                   [-0.566016, 0.341220, -0.750463],
                   [-0.301447, 0.359948, -0.882931],
                   [-0.016569, 0.337054, -0.941340],
                   [0.269519, 0.359948, -0.893195],
                   [0.538825, 0.341220, -0.770219],
                   [0.746565, 0.359948, -0.559534],
                   [0.890147, 0.337054, -0.306648],
                   [0.932765, 0.359948, -0.019684],
                   [0.899028, 0.341220, 0.274442],
                   [-0.750566, 0.480579, 0.453536],
                   [-0.870146, 0.480579, 0.109044],
                   [-0.839270, 0.480579, -0.254304],
                   [-0.663276, 0.480579, -0.573680],
                   [-0.372596, 0.480579, -0.793862],
                   [-0.017491, 0.480579, -0.876777],
                   [0.340638, 0.480579, -0.808090],
                   [0.639869, 0.480579, -0.599677],
                   [0.828460, 0.480579, -0.287574],
                   [0.873802, 0.480579, 0.074253],
                   [-0.718647, 0.545059, 0.431807],
                   [-0.832148, 0.545059, 0.102175],
                   [-0.801764, 0.545059, -0.245124],
                   [-0.632747, 0.545059, -0.550038],
                   [-0.014632, 0.545059, -0.838270],
                   [0.613165, 0.545059, -0.571786],
                   [0.835207, 0.545059, 0.073071]], dtype=float)
    L=-L
    return L
